# ══════════════════════════════════════════════════════════════════════════════
# TEST: Edit Profile
# ══════════════════════════════════════════════════════════════════════════════
# Verifies users can edit their profile information
# Prerequisites: Logged in
# Note: Changes are reverted at end of test
# ══════════════════════════════════════════════════════════════════════════════

appId: com.iayos.app
tags:
  - profile
  - edit
  - form

---

# ─────────────────────────────────────────────────────────────────────────────
# SETUP: Login as Worker
# ─────────────────────────────────────────────────────────────────────────────
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn:
    id: "welcome-login-button"
    optional: true

- waitForAnimationToEnd

- tapOn:
    id: "login-email-input"
- inputText: ${WORKER_EMAIL}
- hideKeyboard

- tapOn:
    id: "login-password-input"
- inputText: ${WORKER_PASSWORD}
- hideKeyboard

- tapOn:
    id: "login-submit-button"

- waitForAnimationToEnd:
    timeout: 10000

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Navigate to Edit Profile
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - text: "Profile"
      - id: "profile-tab"

- waitForAnimationToEnd

- tapOn:
    anyOf:
      - text: "Edit"
      - text: "Edit Profile"
      - id: "edit-profile-button"

- waitForAnimationToEnd

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Edit Form
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Edit Profile"
      - text: "Bio"
      - text: "Name"
      - text: "Save"
    timeout: 10000

- takeScreenshot: "01_edit_form"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Edit Bio
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "bio-input"
      - text: "Bio"
      - text: "About"

# Clear and enter new bio
- inputText: "Maestro E2E Test Bio - This will be reverted"
- hideKeyboard

- takeScreenshot: "02_bio_edited"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Edit Hourly Rate (Worker only)
# ─────────────────────────────────────────────────────────────────────────────
- scroll:
    direction: DOWN

- tapOn:
    anyOf:
      - id: "hourly-rate-input"
      - text: "Hourly Rate"
      - text: "₱/hr"
    optional: true

- inputText: "150"
  optional: true
- hideKeyboard

- takeScreenshot: "03_rate_edited"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Save Button
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Save"
      - text: "Update"
      - id: "save-profile-button"
    optional: true

- takeScreenshot: "04_ready_to_save"

# ─────────────────────────────────────────────────────────────────────────────
# CLEANUP: Cancel without saving
# ─────────────────────────────────────────────────────────────────────────────
# We don't save to avoid polluting user data
- tapOn:
    anyOf:
      - text: "Cancel"
      - text: "Back"
      - id: "back-button"
      - text: "←"
    optional: true

- waitForAnimationToEnd

# Confirm discard if prompted
- tapOn:
    anyOf:
      - text: "Discard"
      - text: "Yes"
      - text: "Don't Save"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "05_cancelled"

# ══════════════════════════════════════════════════════════════════════════════
# TEST: Switch Profile (Dual Profile Users)
# ══════════════════════════════════════════════════════════════════════════════
# Verifies users with dual profiles can switch between WORKER and CLIENT
# Prerequisites: Logged in with dual profile account
# ══════════════════════════════════════════════════════════════════════════════

appId: com.iayos.app
tags:
  - profile
  - switch
  - dual_profile

---

# ─────────────────────────────────────────────────────────────────────────────
# SETUP: Login as Worker
# ─────────────────────────────────────────────────────────────────────────────
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn:
    id: "welcome-login-button"
    optional: true

- waitForAnimationToEnd

- tapOn:
    id: "login-email-input"
- inputText: ${WORKER_EMAIL}
- hideKeyboard

- tapOn:
    id: "login-password-input"
- inputText: ${WORKER_PASSWORD}
- hideKeyboard

- tapOn:
    id: "login-submit-button"

- waitForAnimationToEnd:
    timeout: 10000

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Navigate to Profile
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - text: "Profile"
      - id: "profile-tab"

- waitForAnimationToEnd

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Check Current Profile Type
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Worker"
      - text: "WORKER"
      - text: "Client"
      - text: "CLIENT"
    optional: true
    timeout: 5000

- takeScreenshot: "01_current_profile"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Find Switch Profile Option
# ─────────────────────────────────────────────────────────────────────────────
- scroll:
    direction: DOWN
  optional: true

- tapOn:
    anyOf:
      - text: "Switch to Client"
      - text: "Switch to Worker"
      - text: "Switch Profile"
      - text: "Change Role"
      - id: "switch-profile-button"
    optional: true

- waitForAnimationToEnd:
    timeout: 5000

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Profile Switched
# ─────────────────────────────────────────────────────────────────────────────
# Look for profile type change confirmation
- assertVisible:
    anyOf:
      - text: "Switched"
      - text: "Client"
      - text: "Worker"
      - text: "Profile changed"
    optional: true
    timeout: 5000

- takeScreenshot: "02_profile_switched"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify UI Changed Based on Role
# ─────────────────────────────────────────────────────────────────────────────
# Navigate to home to see role-specific content
- tapOn:
    anyOf:
      - text: "Home"
      - id: "home-tab"
    optional: true

- waitForAnimationToEnd

# Should see role-specific content
- assertVisible:
    anyOf:
      - text: "Post a Job"
      - text: "Find Workers"
      - text: "Browse Jobs"
      - text: "My Applications"
    optional: true

- takeScreenshot: "03_role_specific_content"

# ─────────────────────────────────────────────────────────────────────────────
# CLEANUP: Switch Back (Optional)
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - text: "Profile"
      - id: "profile-tab"
    optional: true

- waitForAnimationToEnd

- scroll:
    direction: DOWN
  optional: true

- tapOn:
    anyOf:
      - text: "Switch to Worker"
      - text: "Switch to Client"
      - text: "Switch Profile"
      - id: "switch-profile-button"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "04_switched_back"

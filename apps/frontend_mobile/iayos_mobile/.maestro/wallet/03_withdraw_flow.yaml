# ══════════════════════════════════════════════════════════════════════════════
# TEST: Withdraw Funds Flow
# ══════════════════════════════════════════════════════════════════════════════
# Verifies withdraw funds UI flow (does NOT complete actual withdrawal)
# Prerequisites: Logged in, GCash account added
# ══════════════════════════════════════════════════════════════════════════════

appId: com.iayos.app
tags:
  - wallet
  - withdraw
  - payment

---

# ─────────────────────────────────────────────────────────────────────────────
# SETUP: Login as Worker
# ─────────────────────────────────────────────────────────────────────────────
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn:
    id: "welcome-login-button"
    optional: true

- waitForAnimationToEnd

- tapOn:
    id: "login-email-input"
- inputText: ${WORKER_EMAIL}
- hideKeyboard

- tapOn:
    id: "login-password-input"
- inputText: ${WORKER_PASSWORD}
- hideKeyboard

- tapOn:
    id: "login-submit-button"

- waitForAnimationToEnd:
    timeout: 10000

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Navigate to Wallet → Withdraw
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - text: "Profile"
      - id: "profile-tab"
    optional: true

- waitForAnimationToEnd

- tapOn:
    anyOf:
      - text: "Wallet"
      - text: "Balance"
      - id: "wallet-section"
    optional: true

- waitForAnimationToEnd

- tapOn:
    anyOf:
      - text: "Withdraw"
      - text: "Cash Out"
      - id: "withdraw-button"

- waitForAnimationToEnd

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Withdraw Screen
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Withdraw"
      - text: "Cash Out"
      - text: "Amount"
      - text: "GCash"
      - text: "Balance"
    timeout: 10000

- takeScreenshot: "01_withdraw_screen"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Balance Display
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Available"
      - text: "Balance"
      - text: "₱"
    timeout: 5000

- takeScreenshot: "02_available_balance"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Enter Withdrawal Amount
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "withdraw-amount-input"
      - text: "Amount"
      - text: "Enter amount"

- inputText: "100"
- hideKeyboard

- takeScreenshot: "03_amount_entered"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Select Quick Amount (if available)
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - text: "₱500"
      - text: "₱1000"
      - text: "₱1K"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "04_quick_amount"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify GCash Account Selection
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "GCash"
      - text: "Select Account"
      - text: "Payment Method"
      - text: "09"
      - text: "Add GCash"
    optional: true

- takeScreenshot: "05_gcash_selection"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Verify Insufficient Balance Message (if applicable)
# ─────────────────────────────────────────────────────────────────────────────
# If balance is 0, should show insufficient funds message
- assertVisible:
    anyOf:
      - text: "Insufficient"
      - text: "Not enough"
      - text: "Withdraw"
      - text: "Continue"
    optional: true

- takeScreenshot: "06_withdraw_validation"

# ─────────────────────────────────────────────────────────────────────────────
# NOTE: We don't actually submit withdrawal to avoid real transactions
# ─────────────────────────────────────────────────────────────────────────────

# ══════════════════════════════════════════════════════════════════════════════
# TEST: Create Job Posting (Client)
# ══════════════════════════════════════════════════════════════════════════════
# Verifies clients can create a new job posting
# Prerequisites: Logged in as CLIENT
# CLEANUP: Job will be deleted via API cleanup after test
# ══════════════════════════════════════════════════════════════════════════════

appId: com.iayos.app
tags:
  - jobs_client
  - create
  - critical

---

# ─────────────────────────────────────────────────────────────────────────────
# SETUP: Login as Client
# ─────────────────────────────────────────────────────────────────────────────
- launchApp:
    clearState: true

- waitForAnimationToEnd

- tapOn:
    id: "welcome-login-button"
    optional: true

- waitForAnimationToEnd

- tapOn:
    id: "login-email-input"
- inputText: ${CLIENT_EMAIL}
- hideKeyboard

- tapOn:
    id: "login-password-input"
- inputText: ${CLIENT_PASSWORD}
- hideKeyboard

- tapOn:
    id: "login-submit-button"

- waitForAnimationToEnd:
    timeout: 10000

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Navigate to Create Job
# ─────────────────────────────────────────────────────────────────────────────
- assertVisible:
    anyOf:
      - text: "Home"
      - text: "Post a Job"
      - text: "My Requests"
      - id: "home-screen"
    timeout: 15000

# Look for create job button
- tapOn:
    anyOf:
      - text: "Post a Job"
      - text: "Create Job"
      - text: "+"
      - id: "create-job-button"
    optional: true

- waitForAnimationToEnd

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Fill Job Title
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "job-title-input"
      - text: "Job Title"
      - text: "Title"

- inputText: "[TEST] Maestro E2E Test Job - Delete Me"
- hideKeyboard

- takeScreenshot: "01_job_title"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Fill Job Description
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "job-description-input"
      - text: "Description"
      - text: "Describe"

- inputText: "This is an automated test job created by Maestro E2E tests. Please delete this job if found in the database. Test ID: MAESTRO_TEST"
- hideKeyboard

- scroll:
    direction: DOWN

- takeScreenshot: "02_job_description"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Select Category
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "job-category-picker"
      - text: "Category"
      - text: "Select Category"
    optional: true

- waitForAnimationToEnd

- tapOn:
    anyOf:
      - text: "Plumbing"
      - text: "Cleaning"
      - text: "General"
    optional: true

- waitForAnimationToEnd

- takeScreenshot: "03_category_selected"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Set Budget
# ─────────────────────────────────────────────────────────────────────────────
- scroll:
    direction: DOWN

- tapOn:
    anyOf:
      - id: "job-budget-input"
      - text: "Budget"
      - text: "₱"

- inputText: "500"
- hideKeyboard

- takeScreenshot: "04_budget_set"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Set Location
# ─────────────────────────────────────────────────────────────────────────────
- tapOn:
    anyOf:
      - id: "job-location-picker"
      - text: "Location"
      - text: "Barangay"
    optional: true

- waitForAnimationToEnd

# Select first available location
- tapOn:
    anyOf:
      - text: "Tetuan"
      - text: "Zone"
      - index: 0
    optional: true

- waitForAnimationToEnd

- scroll:
    direction: DOWN

- takeScreenshot: "05_location_set"

# ─────────────────────────────────────────────────────────────────────────────
# TEST: Submit Job (DRY RUN - Don't actually submit to avoid data pollution)
# ─────────────────────────────────────────────────────────────────────────────
# Note: We verify the form is complete but don't submit to avoid creating
# test data that needs cleanup. The cleanup script handles any created jobs.

- assertVisible:
    anyOf:
      - text: "Post Job"
      - text: "Submit"
      - text: "Create"
      - id: "submit-job-button"
    optional: true

- takeScreenshot: "06_ready_to_submit"

# Uncomment below to actually create job (will be cleaned up by workflow)
# - tapOn:
#     anyOf:
#       - text: "Post Job"
#       - text: "Submit"
#       - id: "submit-job-button"
# 
# - waitForAnimationToEnd:
#     timeout: 10000
# 
# - assertVisible:
#     anyOf:
#       - text: "Job Posted"
#       - text: "Success"
#       - text: "Created"
#     timeout: 10000
